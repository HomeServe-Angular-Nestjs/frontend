<style>
  aside {
    transition: transform 0.3s ease-in-out, width 0.3s ease-in-out;
  }
</style>

<!-- Mobile Overlay -->
<div class="fixed inset-0 bg-black bg-opacity-40 z-30 lg:hidden" *ngIf="isMobileOpen && sidebarMode === 'hidden'"
  (click)="closeMobile()">
</div>

<!-- Sidebar -->
<aside class="fixed top-0 left-0 z-40 h-screen border-r border-gray-200 bg-white flex flex-col" [ngClass]="{
    'w-64': sidebarMode === 'expanded',
    'w-20': sidebarMode === 'collapsed',
    'hidden': sidebarMode === 'hidden' && !isMobileOpen,
    'translate-x-0': isMobileOpen,
    '-translate-x-full': !isMobileOpen && sidebarMode === 'hidden'
  }">

  <!-- Header -->
  <div class="w-full py-4 border-b border-gray-200 flex justify-between items-center px-4">
    <a href="/provider/dashboard" class="flex items-center group">
      <svg width="28" height="22" viewBox="0 0 28 22" fill="none" class="transition-transform group-hover:rotate-12">
        <path d="M13.75 5.98..." class="fill-[#16A34A] group-hover:fill-[#14532D] transition-colors" />
      </svg>

      <span class="ml-2 text-2xl font-bold bg-gradient-to-r from-[#14532D] to-[#16A34A] bg-clip-text text-transparent"
        [ngClass]="{ 'hidden': sidebarMode === 'collapsed' }">
        HomeServe
      </span>
    </a>

    <button class="lg:hidden p-2 rounded-md hover:bg-gray-100" (click)="closeMobile()" *ngIf="sidebarMode === 'hidden'">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <!-- Profile (Hide when collapsed) -->
  <ng-container *ngIf="providerInfo$ | async as provider">
    <div class="px-5 py-4 border-b border-gray-100" *ngIf="sidebarMode !== 'collapsed'">
      <div class="flex items-center gap-3">
        <!-- Avatar -->
        <div class="relative shrink-0">
          <img [src]="provider.avatar || '/assets/images/admin-front-image.png'" referrerpolicy="no-referrer"
            class="h-10 w-10 rounded-full object-cover border border-gray-200 shadow-sm" alt="Provider Avatar" />
          <span class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 border-2 border-white rounded-full"></span>
        </div>

        <!-- Info -->
        <div class="flex flex-col overflow-hidden">
          <h3 class="text-sm font-bold text-gray-800 truncate leading-tight">
            {{ provider.fullname || provider.username }}
          </h3>
          <p class="text-[11px] text-gray-500 truncate mt-0.5">{{ provider.email }}</p>

          <div class="mt-1" *ngIf="provider.profession">
            <span
              class="inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-green-50 text-green-700 border border-green-100">
              {{ provider.profession }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </ng-container>

  <!-- Navigation -->
  <nav class="flex-1 overflow-y-auto p-4 space-y-4">

    <div *ngFor="let item of menuItems" class="space-y-2">
      <h2 class="px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1"
        [ngClass]="{ 'hidden': sidebarMode === 'collapsed' }">
        {{ item.title }}
      </h2>

      <ul class="flex flex-col gap-2">
        <li *ngFor="let subItem of item.subItems">
          <a [routerLink]="subItem.route" routerLinkActive="bg-green-50 text-green-700 border-l-4 border-green-600"
            [routerLinkActiveOptions]="{ exact: true }"
            class="flex items-center gap-3 px-4 py-2 text-sm rounded-lg transition-colors text-gray-700 hover:bg-gray-50">

            <i [class]="subItem.icon + ' w-5'"></i>

            <span [ngClass]="{ 'hidden': sidebarMode === 'collapsed' }">
              {{ subItem.name }}
            </span>
          </a>
        </li>
      </ul>
    </div>

    <div class="mt-auto pt-4 border-t border-gray-200">
      <button (click)="logout()"
        class="flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg">
        <i class="fas fa-sign-out-alt w-5 mr-2"></i>
        <span [ngClass]="{ 'hidden': sidebarMode === 'collapsed' }">Logout</span>
      </button>
    </div>

  </nav>

</aside>