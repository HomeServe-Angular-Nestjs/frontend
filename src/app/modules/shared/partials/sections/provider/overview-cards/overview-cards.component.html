<div
  class="w-full h-full bg-white rounded-xl shadow-sm border border-gray-100
         p-4 min-h-[180px] flex flex-col justify-between transition-all duration-300 ease-in-out hover:shadow-md hover:-translate-y-0.5">

  <!-- Header -->
  <div class="flex justify-between items-center mb-4 gap-2">
    <h3 class="text-gray-800 text-[14px] font-bold tracking-tight truncate">
      {{ data.heading }}
    </h3>
    <button
      class="flex items-center text-green-600 font-semibold text-[11px] hover:text-green-700 transition-colors shrink-0"
      type="button" (click)="onViewDetails()">
      {{ data.detailsText || 'View' }}
      <i class="fa-solid fa-chevron-right ml-1 text-[8px]"></i>
    </button>
  </div>

  <!-- Main Layout Switch -->
  <div class="flex-grow flex flex-col justify-end">
    <ng-container [ngSwitch]="data.boxes.length">

      <!-- Case: 3 Boxes (1 full width + 2 half width) -->
      <ng-container *ngSwitchCase="3">
        <!-- Top main box -->
        <div class="flex justify-between items-center rounded-lg p-3 mb-2 min-h-[70px]
                 bg-green-50 border border-green-100/50">
          <div class="flex-1">
            <p class="text-green-700 text-[11px] font-semibold uppercase tracking-wider mb-0.5">
              {{ data.boxes[0].title }}
            </p>
            <p class="text-gray-900 text-lg font-bold leading-tight">
              {{ formatValue(data.boxes[0].value) }}
            </p>
          </div>
          <div class="w-8 h-8 flex items-center justify-center rounded-lg bg-green-100/80 text-green-700 shrink-0">
            <i class="fa-solid text-sm" [ngClass]="data.boxes[0].icon"></i>
          </div>
        </div>

        <!-- Bottom two boxes -->
        <div class="grid grid-cols-2 gap-2">
          <div *ngFor="let box of data.boxes.slice(1); let i = index"
            class="rounded-lg p-2.5 min-h-[60px] flex flex-col justify-center border" [ngClass]="[
              i === 0 ? 'bg-emerald-50/50 border-emerald-100/50' : 'bg-amber-50/50 border-amber-100/50'
            ]">
            <p class="text-gray-600 text-[10px] font-semibold uppercase tracking-wider mb-0.5">{{ box.title }}</p>
            <p class="text-gray-900 text-base font-bold leading-tight">
              {{ formatValue(box.value) }}
            </p>
          </div>
        </div>
      </ng-container>

      <!-- Case: 2 Boxes (Full width each) -->
      <ng-container *ngSwitchCase="2">
        <div class="flex flex-col gap-2">
          <div *ngFor="let box of data.boxes; let i = index"
            class="rounded-lg p-3 min-h-[65px] flex justify-between items-center border" [ngClass]="[
              i === 0 ? 'bg-sky-50/50 border-sky-100/50' : 'bg-pink-50/50 border-pink-100/50'
            ]">
            <div class="flex-1">
              <p class="text-gray-600 text-[10px] font-semibold uppercase tracking-wider mb-0.5">{{ box.title }}</p>
              <p class="text-gray-900 text-base font-bold leading-tight">
                {{ formatValue(box.value) }}
              </p>
            </div>
            <div
              class="w-8 h-8 flex items-center justify-center rounded-lg bg-white/80 shadow-sm shrink-0 font-bold border border-gray-100">
              <i class="fa-solid text-gray-700 text-sm" [ngClass]="box.icon"></i>
            </div>
          </div>
        </div>
      </ng-container>

      <!-- Default (1 or >3 Boxes) -->
      <ng-container *ngSwitchDefault>
        <div class="grid gap-2" [ngClass]="{
            'grid-cols-1': data.boxes.length === 1,
            'grid-cols-2': data.boxes.length > 1
          }">
          <div *ngFor="let box of data.boxes; let i = index"
            class="rounded-lg p-3 min-h-[65px] flex flex-col justify-center border" [ngClass]="[
              i % 3 === 0
                ? 'bg-green-50/50 border-green-100/50'
                : i % 3 === 1
                ? 'bg-teal-50/50 border-teal-100/50'
                : 'bg-rose-50/50 border-rose-100/50'
            ]">
            <p class="text-gray-600 text-[10px] font-semibold uppercase tracking-wider mb-0.5">{{ box.title }}</p>
            <p class="text-gray-900 text-base font-bold leading-tight">
              {{ formatValue(box.value) }}
            </p>
          </div>
        </div>
      </ng-container>
    </ng-container>
  </div>
</div>