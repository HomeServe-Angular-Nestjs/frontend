<section class="w-full">
  <!-- Bookings Table Container -->
  <div class="overflow-hidden">
    <ng-container *ngIf="bookingResponseData$ | async as bookingResponseData">
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">

          <!-- Table Header -->
          <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
            <tr>
              <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                Booking ID
              </th>
              <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                Customer
              </th>
              <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                Date & Time
              </th>
              <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                Status
              </th>
              <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                Payment
              </th>
              <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                Cancel
              </th>
              <ng-container *ngIf="actionable">
                <th class="px-6 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider">
                  Actions
                </th>
              </ng-container>
            </tr>
          </thead>

          <!-- Table Body -->
          <tbody class="bg-white divide-y divide-gray-200">
            <ng-container *ngFor="let booking of bookingResponseData.bookingData; let i = index">
              <tr class="hover:bg-green-50/30 transition-colors duration-200 group">

                <!-- Booking ID -->
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="flex items-center gap-2">
                    <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
                      <i class="fas fa-hashtag text-green-600 text-xs"></i>
                    </div>
                    <span class="text-sm font-semibold text-gray-900">
                      {{ booking.bookingId.toUpperCase() | slice: 0:10 }}
                    </span>
                  </div>
                </td>

                <!-- Customer Info -->
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="flex items-center gap-3">
                    <img [src]="booking.customer.avatar" alt="Customer" class="h-10 w-10 rounded-full object-cover border-2 border-gray-200 
                             group-hover:border-green-300 transition-colors" loading="lazy"
                      (error)="onImageError($event)" />
                    <div>
                      <p class="text-sm font-semibold text-gray-900">
                        {{ booking.customer.name }}
                      </p>
                      <p class="text-xs text-gray-500">
                        {{ booking.customer.email }}
                      </p>
                    </div>
                  </div>
                </td>

                <!-- Date & Time -->
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="flex items-center gap-2">
                    <i class="fas fa-clock text-gray-400 text-sm"></i>
                    <div>
                      <p class="text-sm font-medium text-gray-900">
                        {{ getDate(booking.expectedArrivalTime) }}
                      </p>
                      <p class="text-xs text-gray-500">
                        {{ getTime(booking.expectedArrivalTime) }}
                      </p>
                    </div>
                  </div>
                </td>

                <!-- Booking Status -->
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-bold" [ngClass]="{
                      'bg-green-100 text-green-700 border border-green-200': booking.bookingStatus === 'completed',
                      'bg-yellow-100 text-yellow-700 border border-yellow-200': booking.bookingStatus === 'pending',
                      'bg-blue-100 text-blue-700 border border-blue-200': booking.bookingStatus === 'in_progress',
                      'bg-red-100 text-red-700 border border-red-200': booking.bookingStatus === 'cancelled'
                    }">
                    {{ booking.bookingStatus }}
                  </span>
                </td>

                <!-- Payment Status -->
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-bold" [ngClass]="{
                      'bg-green-100 text-green-700 border border-green-200': booking.paymentStatus === 'paid',
                      'bg-gray-100 text-gray-600 border border-gray-200': booking.paymentStatus !== 'paid'
                    }">
                    {{ booking.paymentStatus }}
                  </span>
                </td>

                <!-- Cancel Request -->
                <td class="px-6 py-4 whitespace-nowrap">
                  <ng-container [ngSwitch]="booking.cancelStatus">
                    <span *ngSwitchCase="'in_progress'" class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-bold 
                             bg-orange-100 text-orange-700 border border-orange-200">
                      Requested
                    </span>
                    <span *ngSwitchCase="'cancelled'" class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-bold 
                             bg-red-100 text-red-700 border border-red-200">
                      Cancelled
                    </span>
                    <span *ngSwitchDefault class="text-xs font-medium text-gray-400">â€”</span>
                  </ng-container>
                </td>

                <!-- Actions -->
                <ng-container *ngIf="actionable">
                  <td class="px-6 py-4 whitespace-nowrap text-center">
                    <div class="flex justify-center items-center gap-3">
                      <a [routerLink]="[booking.bookingId]"
                        class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-all" title="View Details">
                        <i class="fas fa-eye"></i>
                      </a>

                      <button (click)="goToChat(booking.customer.id)"
                        class="p-2 text-green-600 hover:bg-green-50 rounded-lg transition-all" title="Message Customer">
                        <i class="fas fa-comment"></i>
                      </button>

                      <button class="p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-all" title="More Options">
                        <i class="fas fa-ellipsis-v"></i>
                      </button>
                    </div>
                  </td>
                </ng-container>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <ng-container *ngIf="actionable">
        <div class="border-t border-gray-200 bg-gray-50">
          <app-provider-pagination [pagination]="bookingResponseData.paginationData"
            (pageChange)="loadBookings($event)">
          </app-provider-pagination>
        </div>
      </ng-container>
    </ng-container>
  </div>
</section>