<!-- Container -->
<div class="space-y-8 p-6 bg-gray-50 rounded-xl shadow-md">

    <!-- Professional Introduction -->
    <section class="relative bg-white p-6 rounded-lg shadow space-y-2">
        <h2 class="text-xl font-semibold text-gray-800">Professional Introduction</h2>

        <!-- View Mode -->
        <ng-container *ngIf="!isEditingIntro">
            <p *ngIf="providerBio && providerBio.trim().length > 0; else emptyBio"
                class="text-gray-700 leading-relaxed">
                {{ providerBio }}
            </p>
            <ng-template #emptyBio>
                <p class="text-gray-400 italic">No professional introduction added yet.</p>
            </ng-template>
        </ng-container>

        <!-- Edit Mode -->
        <textarea *ngIf="isEditingIntro" [(ngModel)]="providerBio" placeholder="Type something..."
            class="w-full h-40 p-3 border border-gray-300 rounded-md text-gray-700 resize-none focus:outline-none focus:ring-2 focus:ring-green-400"></textarea>

        <!-- Toggle Button (Edit <-> Save) -->
        <button aria-label="Toggle Edit" (click)="toggleIntroEdit()" [ngClass]="[
            'absolute right-4 text-gray-500 hover:text-green-600 transition',
            isEditingIntro ? 'bottom-1' : 'bottom-4'
            ]">
            <i [ngClass]="isEditingIntro ? 'fas fa-check' : 'fas fa-pen'"></i>
        </button>
    </section>


    <!-- Specializations & Expertise -->
    <section class="relative bg-white p-6 rounded-lg shadow space-y-4">
        <h2 class="text-xl font-semibold text-gray-800">Specializations & Expertise</h2>

        <!-- Main Expertises -->
        <div class="flex flex-wrap gap-4">
            <ng-container *ngIf="expertises.length > 0; else noExpertise">
                <div *ngFor="let expertise of expertises"
                    class="relative bg-green-50 border border-green-200 text-green-800 px-4 py-2 rounded-lg">

                    <!-- Delete Button -->
                    <button (click)="deleteSpecialization(expertise)"
                        class="absolute top-1 right-2 text-red-400 hover:text-red-600">
                        <i class="fas fa-trash-alt text-xs"></i>
                    </button>

                    <div class="font-semibold">{{ expertise.label }}</div>
                    <div class="text-sm text-gray-500">{{ expertise.specialization }}</div>
                </div>
            </ng-container>

            <!-- Empty State Template -->
            <ng-template #noExpertise>
                <div class="text-gray-500 italic">No specializations added yet.</div>
            </ng-template>
        </div>

        <!-- Additional Skills -->
        <div>
            <h3 class="text-sm font-semibold text-gray-600 mb-2">Additional Skills</h3>
            <ng-container *ngIf="additionalSkills.size > 0; else noAdditionalSkills">
                <div *ngFor="let skill of additionalSkills"
                    class="relative bg-gray-100 px-3 py-1 rounded-full text-sm flex items-center gap-2">
                    {{ skill }}
                    <button (click)="removeAdditionalSkill(skill)" class="text-red-400 hover:text-red-600">
                        <i class="fas fa-times-circle text-xs"></i>
                    </button>
                </div>
            </ng-container>

            <!-- Empty State Template -->
            <ng-template #noAdditionalSkills>
                <div class="text-gray-500 italic">No additional skills listed.</div>
            </ng-template>
        </div>

        <!-- Edit Button -->
        <button (click)="openSpecializationsModal()" aria-label="Edit Specializations"
            class="absolute bottom-4 right-4 text-gray-500 hover:text-green-600">
            <i class="fas fa-pen"></i>
        </button>
    </section>

    <!-- Awards & Recognition -->
    <section class="relative bg-white p-6 rounded-lg shadow space-y-3">
        <h2 class="text-xl font-semibold text-gray-800">Awards & Recognition</h2>
        <div class="flex items-start gap-3">
            <div class="text-yellow-500 text-2xl">üèÜ</div>
            <div>
                <div class="font-medium text-gray-700">Best Service Provider 2023</div>
                <div class="text-sm text-gray-500">HomeServe Annual Awards</div>
            </div>
        </div>
    </section>

    <!-- Active Certifications -->
    <section class="relative bg-white p-6 rounded-lg shadow space-y-4">
        <h2 class="text-xl font-semibold text-gray-800">Active Certifications</h2>

        <div *ngIf="docs.length > 0; else noCerts" class="grid gap-4 md:grid-cols-2">
            <div *ngFor="let cert of docs" class="bg-green-50 border border-green-200 rounded-md p-4 relative">

                <!-- Certificate Image -->
                <img [src]="cert.fileUrl" alt="Certificate" class="w-full h-32 object-cover rounded shadow-md mb-3" />

                <!-- Certificate Details -->
                <div class="space-y-1">
                    <div class="font-semibold text-green-800">{{ cert.label }}</div>
                    <div class="text-sm text-gray-600">Uploaded: {{ cert.uploadedAt | date: 'mediumDate' }}</div>
                    <div class="text-sm">
                        Status:
                        <span [ngClass]="{
                            'text-yellow-600': cert.verificationStatus === 'pending',
                            'text-green-600': cert.verificationStatus === 'verified',
                            'text-red-500': cert.verificationStatus === 'rejected'
                            }">
                            {{ cert.verificationStatus | titlecase }}
                        </span>
                    </div>

                    <div *ngIf="cert.verificationStatus === 'verified' && cert.verifiedAt"
                        class="text-xs text-gray-500">
                        Verified on {{ cert.verifiedAt | date: 'shortDate' }}
                    </div>
                </div>

                <!-- Optional Delete/Edit buttons -->
                <div class="absolute top-3 right-3 space-x-2">
                    <button class="text-green-500 hover:text-green-700" title="Edit">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="text-red-500 hover:text-red-700" title="Delete">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- No Certifications -->
        <ng-template #noCerts>
            <div class="text-gray-500 italic">No certifications uploaded yet.</div>
        </ng-template>

        <!-- Modal Open Trigger -->
        <button (click)="openCertificationModal()" aria-label="Edit Certifications"
            class="absolute bottom-4 right-4 text-gray-500 hover:text-green-600">
            <i class="fas fa-pen"></i>
        </button>
    </section>


    <!-- Languages -->
    <section class="relative bg-white p-6 rounded-lg shadow space-y-4">
        <h2 class="text-xl font-semibold text-gray-800">Languages</h2>

        <!-- Language Tags -->
        <div *ngIf="languages.length > 0; else noLanguages" class="flex flex-wrap gap-2">
            <div *ngFor="let lang of languages" class="relative">
                <span class="flex items-center gap-2 bg-green-100 text-green-800 text-sm px-3 py-1 rounded-full pr-8">
                    {{ lang.language }}
                    <span class="text-gray-500 text-xs">({{ lang.proficiency }})</span>
                </span>

                <!-- Remove Button -->
                <button class="absolute top-1 right-1 text-red-400 hover:text-red-600" aria-label="Remove language">
                    <i class="fas fa-times-circle text-xs"></i>
                </button>
            </div>
        </div>

        <!-- No Languages Message -->
        <ng-template #noLanguages>
            <p class="text-gray-500 italic text-sm">No languages added yet.</p>
        </ng-template>

        <!-- Edit Button -->
        <button (click)="openLanguageModal()" aria-label="Edit Languages"
            class="absolute bottom-4 right-4 text-gray-500 hover:text-green-600">
            <i class="fas fa-pen"></i>
        </button>
    </section>



</div>

<!--* Modals -->
<div *ngIf="isSpecializationsModalOpen"
    class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50">
    <form [formGroup]="expertiseForm" (submit)="saveExpertise()"
        class="bg-white rounded-lg p-6 w-full max-w-xl shadow-lg space-y-4">
        <h3 class="text-lg font-semibold text-gray-800">Edit Specializations & Expertise</h3>

        <!-- Specialization Input -->
        <div class="space-y-3">
            <label class="block">
                <span class="text-sm text-gray-600">Specialization</span>
                <input type="text" formControlName="specialization"
                    class="mt-1 w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring focus:ring-green-400"
                    placeholder="e.g., Deep Cleaning" />
            </label>

            <label class="block">
                <span class="text-sm text-gray-600">Label</span>
                <input type="text" formControlName="label"
                    class="mt-1 w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring focus:ring-green-400"
                    placeholder="e.g., Carpet Cleaning, Sanitization" />
            </label>

            <!-- Additional Skills -->
            <label class="block">
                <span class="text-sm text-gray-600">Add Additional Skill</span>
                <div class="flex items-center gap-2 mt-1">
                    <input type="text" formControlName="additionalSkills" class=" flex-1 border border-gray-300 rounded-md p-2 focus:outline-none focus:ring
                        focus:ring-green-400" placeholder="e.g., Window Washing" />
                    <button type="button" (click)="addAdditionalSkill()"
                        class="px-3 py-1 bg-yellow-600 text-white rounded hover:bg-yellow-700 text-sm">Add</button>
                </div>
            </label>

            <!-- List Existing Skills -->
            <div *ngIf="additionalSkills.size > 0" class="mt-3">
                <span class="text-sm text-gray-600">Existing Additional Skills:</span>
                <div class="flex flex-wrap gap-2 mt-2">
                    <div *ngFor="let skill of additionalSkills"
                        class="flex items-center gap-1 px-3 py-1 bg-gray-100 rounded-full text-sm">
                        {{ skill }}
                        <button (click)="removeAdditionalSkill(skill)" aria-label="Remove skill"
                            class="text-red-400 hover:text-red-600">
                            <i class="fas fa-times-circle text-xs"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-end gap-3 mt-4">
            <button (click)="closeSpecializationsModal()"
                class="px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300 text-sm">
                Cancel
            </button>
            <button type="submit" class="px-4 py-2 rounded-md bg-green-600 text-white hover:bg-green-700 text-sm">
                Save
            </button>
        </div>
    </form>
</div>

<div *ngIf="isCertificationModalOpen"
    class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50">
    <div class="bg-white rounded-lg p-6 w-full max-w-lg shadow-lg space-y-4">

        <h3 class="text-lg font-semibold text-gray-800">Upload Certification</h3>

        <!-- Certification Name -->
        <div>
            <label class="block text-sm text-gray-600 mb-1">Certification Title</label>
            <input type="text"
                class="w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring focus:ring-green-400"
                placeholder="e.g., Professional Cleaning" />
        </div>

        <!-- Image Upload -->
        <div>
            <label class="block text-sm text-gray-600 mb-1">Upload Certificate</label>
            <div class="border border-dashed border-gray-300 rounded-md p-4 text-center cursor-pointer">
                <input type="file" (change)="handleFileInput($event)" class="hidden" #fileInput />
                <div (click)="fileInput.click()" class="text-gray-500">
                    Click to upload or drag and drop
                </div>
                <div *ngIf="" class="mt-2">
                    <img [src]="" alt="Preview" class="mx-auto w-40 rounded shadow" />
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div class="flex justify-end gap-3">
            <button (click)="closeCertificationModal()" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                Cancel
            </button>
            <button (click)="saveCertification()"
                class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded text-sm">
                Save
            </button>
        </div>

    </div>
</div>

<div *ngIf="isLanguageModalOpen" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50">
    <div class="bg-white rounded-lg p-6 w-full max-w-md space-y-4 shadow-lg">

        <h3 class="text-lg font-semibold text-gray-800">Manage Languages</h3>

        <!-- Input Fields -->
        <div class="space-y-3">
            <label class="block text-sm text-gray-600">
                Language
                <input type="text" placeholder="e.g., German"
                    class="w-full mt-1 border border-gray-300 rounded-md p-2 focus:outline-none focus:ring focus:ring-green-400">
            </label>

            <label class="block text-sm text-gray-600">
                Proficiency
                <select
                    class="w-full mt-1 border border-gray-300 rounded-md p-2 focus:outline-none focus:ring focus:ring-green-400">
                    <option value="" disabled selected>Select Proficiency</option>
                    <option>Native</option>
                    <option>Fluent</option>
                    <option>Conversational</option>
                    <option>Basic</option>
                </select>
            </label>
            <button (click)="addLanguage()"
                class="w-full bg-green-600 text-white py-2 rounded-md hover:bg-green-700 text-sm">
                Add Language
            </button>
        </div>

        <!-- Existing Languages List -->
        <div *ngIf="languages.length > 0" class="pt-2">
            <h4 class="text-sm font-semibold text-gray-700 mb-1">Added Languages:</h4>
            <ul class="space-y-2">
                <li *ngFor="let lang of languages; let i = index"
                    class="flex items-center justify-between text-sm bg-gray-50 border border-gray-200 rounded-md px-3 py-2">
                    <span>{{ lang.language }} <span class="text-gray-500 text-xs">({{ lang.proficiency }})</span></span>
                    <button (click)="removeLanguage(i)" class="text-red-500 hover:text-red-700">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </li>
            </ul>
        </div>

        <!-- Modal Actions -->
        <div class="flex justify-end gap-3 pt-4">
            <button (click)="closeLanguageModal()"
                class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-md text-sm">Cancel</button>
            <button (click)="saveLanguages()"
                class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md text-sm">Save</button>
        </div>

    </div>
</div>