<section id="explore"
  class="relative bg-gradient-to-b from-indigo-50/60 via-purple-50/20 to-white pt-6 pb-16 lg:pt-16 lg:pb-24 overflow-hidden">

  <!-- Animated Background Shapes -->
  <div class="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0">
    <div
      class="absolute -top-24 -left-24 w-96 h-96 bg-indigo-200/30 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob">
    </div>
    <div
      class="absolute top-0 -right-4 w-96 h-96 bg-purple-200/30 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob animation-delay-2000">
    </div>
    <div
      class="absolute -bottom-8 left-20 w-72 h-72 bg-pink-200/30 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob animation-delay-4000">
    </div>
  </div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
    <div class="grid lg:grid-cols-2 gap-12 lg:gap-16 items-center">

      <!-- Left Column: Content & Search -->
      <div class="flex flex-col gap-8 animate-fadeInLeft">
        <!-- Text Content -->
        <div class="space-y-4">
          <div
            class="inline-flex items-center gap-2 px-3 py-1 bg-indigo-100/80 text-indigo-700 rounded-full text-xs font-bold uppercase tracking-wide w-fit">
            <span class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></span>
            Home Services On Demand
          </div>
          <h1 class="text-4xl md:text-5xl lg:text-6xl font-extrabold text-gray-900 tracking-tight leading-[1.1]">
            Expert Help for Your <br>
            <span
              class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-600">Home
              Needs</span>
          </h1>
          <p class="text-md text-gray-600 max-w-lg leading-relaxed">
            Find trusted professionals for cleaning, repair, and maintenance. Book instantly with confidence and enjoy a
            hassle-free experience.
          </p>
        </div>

        <!-- Search Widget Card -->
        <div
          class="bg-white/70 backdrop-blur-2xl border border-white/60 p-6 md:p-8 rounded-[2.5rem] shadow-[0_32px_64px_-16px_rgba(79,70,229,0.1)] relative">

          <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Service Input Group -->
            <div class="space-y-2.5 relative group">
              <div class="flex items-center px-1 h-5">
                <label class="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]">Service Category</label>
              </div>
              <div class="relative">
                <div class="absolute left-4 top-1/2 -translate-y-1/2 flex items-center justify-center w-5 h-5">
                  <i
                    class="fas fa-tools text-slate-400 group-focus-within:text-indigo-600 transition-colors text-sm"></i>
                </div>
                <input [(ngModel)]="serviceSearch" (ngModelChange)="filterTitle($event)" placeholder="What do you need?"
                  class="w-full pl-12 pr-4 py-3.5 bg-slate-50/50 border border-slate-100 rounded-2xl focus:bg-white focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-400 text-sm font-semibold text-slate-700">
              </div>

              <!-- Service Dropdown -->
              <div *ngIf="isServiceSearchDropdownOpen && serviceSearch"
                class="absolute top-full left-0 w-full mt-3 bg-white rounded-3xl shadow-2xl border border-slate-100 overflow-hidden py-1.5 z-50 animate-fadeIn">
                <ng-container *ngIf="(serviceTitles$ | async) as serviceTitles; else noTitlesFound">
                  <ng-container *ngIf="serviceTitles.length; else noTitlesFound">
                    <button *ngFor="let service of serviceTitles"
                      (click)="serviceSearch = service; isServiceSearchDropdownOpen = false; selectedService = service"
                      class="w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 hover:text-indigo-600 transition-colors flex items-center gap-3">
                      <div class="w-8 h-8 rounded-xl bg-indigo-50 flex items-center justify-center text-indigo-500">
                        <i class="fas fa-search text-xs"></i>
                      </div>
                      <span class="font-bold tracking-tight">{{ service }}</span>
                    </button>
                  </ng-container>
                </ng-container>
                <ng-template #noTitlesFound>
                  <div class="px-4 py-6 text-sm text-slate-400 text-center font-bold">No services found</div>
                </ng-template>
              </div>
            </div>

            <!-- Location Input Group -->
            <div class="space-y-2.5 relative group">
              <div class="flex justify-between items-center px-1 h-5">
                <label class="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]">Live Location</label>
                <button (click)="!loadingCurrentLocation && detectCurrentLocation()"
                  class="text-[10px] font-black text-indigo-600 hover:text-indigo-700 flex items-center gap-1.5 transition-colors group/btn">
                  <ng-container *ngIf="!loadingCurrentLocation">
                    <i class="fas fa-location-crosshairs group-hover/btn:rotate-90 transition-transform"></i> Detect
                  </ng-container>
                  <ng-container *ngIf="loadingCurrentLocation">
                    <i class="fas fa-spinner fa-spin"></i>
                  </ng-container>
                </button>
              </div>
              <div class="relative">
                <div class="absolute left-4 top-1/2 -translate-y-1/2 flex items-center justify-center w-5 h-5">
                  <i
                    class="fas fa-map-marker-alt text-slate-400 group-focus-within:text-indigo-600 transition-colors text-sm"></i>
                </div>
                <input [(ngModel)]="locationSearch" (ngModelChange)="findLocation($event)" placeholder="Where?"
                  class="w-full pl-12 pr-4 py-3.5 bg-slate-50/50 border border-slate-100 rounded-2xl focus:bg-white focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-400 text-sm font-semibold text-slate-700">
              </div>

              <!-- Location Dropdown -->
              <div *ngIf="isLocationSearchDropdownOpen && locationSearch"
                class="absolute top-full left-0 w-full mt-3 bg-white rounded-3xl shadow-2xl border border-slate-100 overflow-hidden py-1.5 z-50 animate-fadeIn">
                <ng-container *ngIf="(locationData$ | async) as locationData; else searching">
                  <ng-container *ngIf="locationData.length; else searching">
                    <button *ngFor="let location of locationData"
                      (click)="locationSearch = location.address; isLocationSearchDropdownOpen = false; selectedLocation = location"
                      class="w-full text-left px-4 py-3.5 text-sm text-slate-700 hover:bg-slate-50 hover:text-indigo-600 transition-colors border-b border-slate-50 last:border-0 flex items-center gap-3">
                      <div class="w-8 h-8 rounded-xl bg-indigo-50 flex items-center justify-center text-indigo-500">
                        <i class="fas fa-map-pin text-xs"></i>
                      </div>
                      <span class="block truncate font-bold tracking-tight">{{ location.address }}</span>
                    </button>
                  </ng-container>
                </ng-container>
                <ng-template #searching>
                  <div class="px-4 py-6 text-sm text-slate-400 text-center font-bold">
                    <span *ngIf="isLocationSearchLoading"><i class="fas fa-spinner fa-spin mr-2"></i>Finding
                      location...</span>
                    <span *ngIf="!isLocationSearchLoading">No results found</span>
                  </div>
                </ng-template>
              </div>
            </div>
          </div>

          <button (click)="findProviders()"
            class="group w-full bg-indigo-600 hover:bg-slate-900 text-white font-black py-4 rounded-2xl shadow-[0_12px_24px_-8px_rgba(79,70,229,0.4)] hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-3">
            Search for Professionals
            <i class="fas fa-arrow-right text-xs group-hover:translate-x-2 transition-transform"></i>
          </button>
        </div>

        <!-- Popular Categories -->
        <div class="bg-white/50 backdrop-blur-sm border border-white/60 p-4 rounded-2xl">
          <p class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 ml-1">Popular Services</p>
          <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
            <a *ngFor="let service of services" [routerLink]="['/','view_providers']"
              [queryParams]="{category: service.route}"
              class="flex flex-col items-center justify-center gap-2 p-3 bg-white border border-gray-100 rounded-xl hover:border-indigo-200 hover:shadow-md hover:-translate-y-1 transition-all duration-300 cursor-pointer group">
              <div
                class="w-10 h-10 rounded-full bg-indigo-50 text-indigo-500 flex items-center justify-center text-lg group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                <i [class]="'fas ' + service.icon"></i>
              </div>
              <span class="text-xs font-semibold text-gray-700 group-hover:text-indigo-700">{{ service.title }}</span>
            </a>
          </div>
        </div>
      </div>

      <!-- Right Column: Visual Showcase -->
      <div class="hidden lg:block relative animate-fadeInRight py-4">
        <!-- Showcase Wrapper -->
        <div class="relative w-full max-w-[460px] ml-auto">

          <!-- Abstract Background Decorations -->
          <div
            class="absolute -top-16 -right-16 w-72 h-72 bg-gradient-to-br from-indigo-200/30 to-purple-200/30 rounded-full blur-3xl animate-blob">
          </div>
          <div
            class="absolute -bottom-16 -left-16 w-72 h-72 bg-gradient-to-br from-pink-200/30 to-indigo-200/30 rounded-full blur-3xl animate-blob animation-delay-2000">
          </div>

          <!-- Main Carousel Container -->
          <div class="relative group">
            <!-- Glassy Frame (Refined Border) -->
            <div
              class="relative rounded-[3rem] overflow-hidden p-1.5 bg-gradient-to-br from-white/40 to-white/10 backdrop-blur-sm border border-white/40 shadow-[0_32px_64px_-16px_rgba(79,70,229,0.15)] transition-all duration-500 group-hover:shadow-[0_48px_80px_-20px_rgba(79,70,229,0.25)]">

              <div class="relative aspect-[4/5] overflow-hidden rounded-[2.8rem]">
                <!-- Images with Ken Burns effect -->
                <div class="absolute inset-0 bg-gray-50" #carousel>
                  <ng-container *ngFor="let image of images; let imgIdx = index">
                    <img [src]="image.src" [alt]="image.alt"
                      class="absolute inset-0 w-full h-full object-cover transition-all duration-[1500ms] ease-out"
                      [ngClass]="{
                        'opacity-0 scale-110 rotate-1': currentSlide !== imgIdx,
                        'opacity-100 scale-100 rotate-0': currentSlide === imgIdx
                      }">
                  </ng-container>
                </div>

                <!-- Dynamic Overlays -->
                <div class="absolute inset-0 bg-gradient-to-t from-gray-900/80 via-gray-900/20 to-transparent"></div>

                <!-- Vertical Progress Indicators -->
                <div class="absolute left-6 top-1/2 -translate-y-1/2 flex flex-col gap-2.5 z-20">
                  <button *ngFor="let image of images; let dotIdx = index" (click)="goToSlide(dotIdx)"
                    class="group relative h-10 w-1 flex items-center justify-center">
                    <div class="absolute inset-0 bg-white/20 rounded-full overflow-hidden">
                      <div class="h-full bg-white transition-all duration-500 ease-out"
                        [style.height]="currentSlide === dotIdx ? '100%' : '0%'"></div>
                    </div>
                    <span
                      class="absolute left-4 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all text-[10px] font-bold text-white uppercase tracking-widest whitespace-nowrap">0{{dotIdx
                      + 1}}</span>
                  </button>
                </div>

                <!-- Premium Glass Card Overlay -->
                <div class="absolute bottom-6 left-6 right-6 z-20">
                  <div
                    class="p-6 rounded-[2rem] bg-white/10 backdrop-blur-xl border border-white/20 shadow-2xl overflow-hidden">
                    <!-- Subtle shimmer effect -->
                    <div
                      class="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full animate-shimmer">
                    </div>

                    <div class="relative">
                      <div class="flex items-center gap-2 mb-3">
                        <div
                          class="px-2 py-0.5 bg-indigo-500/80 rounded-full text-[9px] font-black uppercase tracking-widest text-white">
                          Verified</div>
                        <div class="h-1 w-1 rounded-full bg-white/40"></div>
                        <div class="text-[10px] font-bold text-indigo-100 uppercase tracking-widest">Premium Service
                        </div>
                      </div>
                      <h4 class="text-2xl font-black text-white leading-tight mb-2 tracking-tight">Trust the Expert Hand
                        <br>for Your Home
                      </h4>
                      <p class="text-white/60 text-xs leading-relaxed max-w-[280px]">Experience excellence in every
                        detail. Our certified professionals ensure your peace of mind with every booking.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>